<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/Header.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/sprite.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/UhfHeader.css" data-do-not-move="true" />
<link rel="stylesheet" href="https://statics-uhf-wus.akamaized.net/west-european/shell/_scrf/css/themes=default.device=uplevel_web_pc/2f-4d7bb3/16-2a8b93/a7-5fcd4e/e5-4543a3/ac-64ad48/d8-a01341/ca-4fb444/e6-7dc25c?ver=2.0" type="text/css" media="all" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:sprite,0:Footer,1:ImageSprite,2:SelectLocaleFromPopUp;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/WindowsApps/Content:1,/Areas/Epx/Themes/Base/Content:2&amp;amp;v=981A1D272D62878797A67C6FD28CE65F" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Areas/Epx/Themes/Windows/Content/UhfFooter.css?v=636582197398493108" data-do-not-move="true" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Export DataSet to Excel  file with multiple sheets (NO &quot;3d&quot; party libraries).</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/0de484cc-5f72-470e-90dd-d4049574ef28Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/windowsapps/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/windowsapps/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Export DataSet to Excel  file with multiple sheets (NO &quot;3d&quot; party libraries).</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, vb, XML, export to excel
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            C#, vb, Excel
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Phone, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/12/2018</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><span>WEB application - how to export Data Set to Excel file with multiple sheets.</span></p>
<p><span>Logic working with ANY chars in the column(s), it uses StringBuilder for build output string, this approach radically increases performance.</span></p>
<p>&nbsp;</p>
<p><img id="197765" src="description/Excel.PNG" alt="" width="739" height="468"></p>
<h1>Description</h1>
<p>Select button [Export To Excel] and [Save] or [Open] file.</p>
<p>&nbsp;</p>
<p><img id="197766" src="description/Export.PNG" alt="" width="481" height="224"></p>
<p>&nbsp;</p>
<h3>Build the Sample</h3>
<ol>
<li>Start Visual Studio&nbsp; 2015 for Windows&nbsp; and select&nbsp;<strong>File</strong>&nbsp;&gt;<strong>Open</strong>&nbsp;&gt;&nbsp;<strong>Project/Solution</strong>.
</li><li>Go to the directory in which you unzipped the sample. Go to the directory named for the sample, and double-click the Visual Studio&nbsp; 2015 for Windows&nbsp; &nbsp;Solution (.sln) file.
</li><li>Press F7 or use&nbsp;<strong>Build</strong>&nbsp;&gt;&nbsp;<strong>Build Solution</strong>&nbsp;to build the sample.
</li></ol>
<p>&nbsp;</p>
<h3>&nbsp;Run the sample</h3>
<p>To debug the app and then run it, press F5 or use&nbsp;<strong>Debug</strong>&nbsp;&gt;&nbsp;<strong>Start Debugging</strong>. To execute the app without debugging, press Ctrl&#43;F5 or use&nbsp;<strong>Debug</strong>&nbsp;&gt;&nbsp;<strong>Start Without Debugging</strong>.</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">       void exportDataSetToExcel(HttpResponse respObj, DataSet DS, string fileName)
        {

            fileName = fileName &#43; &quot;.xml&quot;;

            StringBuilder sb = new StringBuilder();

            sb.Append(@&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot;?&gt; &quot;);
            sb.AppendLine(@&quot;&lt;?mso-application progid=&quot;&quot;Excel.Sheet&quot;&quot;?&gt; &quot;);
            sb.AppendLine(@&quot;&lt;Workbook xmlns=&quot;&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;&quot; &quot;);
            sb.AppendLine(@&quot;xmlns:x=&quot;&quot;urn:schemas-microsoft-com:office:excel&quot;&quot; &quot;);
            sb.AppendLine(@&quot;xmlns:ss=&quot;&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;&quot; &quot;);
            sb.AppendLine(@&quot;xmlns:html=&quot;&quot;http://www.w3.org/TR/REC-html40&quot;&quot;&gt; &quot;);
            sb.AppendLine(&quot;&quot;);

            foreach (DataTable tbl in DS.Tables)
            {
                <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://msdn.microsoft.com/en-US/library/System.Data.DataRow.aspx"  title="Auto generated link to System.Data.DataRow">System.Data.DataRow</a> dr;

                sb.AppendLine(@&quot;&lt;Worksheet ss:Name=&quot;&quot;&quot; &#43; tbl.TableName &#43; @&quot;&quot;&quot;&gt;&quot;);
                sb.AppendLine(&quot;&lt;Table&gt;&quot;);

                // see XML Spreadsheet Reference https://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx
                sb.AppendLine(@&quot;&lt;Column ss:Index=&quot;&quot;1&quot;&quot; ss:AutoFitWidth=&quot;&quot;0&quot;&quot; ss:Width=&quot;&quot;110&quot;&quot;/&gt;&quot;);

                // First Row as Column's Name
                sb.AppendLine(&quot;&lt;Row&gt;&quot;);
                foreach (DataColumn dc in tbl.Columns)
                {
                    sb.AppendLine(@&quot;&lt;Cell&gt;&lt;Data ss:Type=&quot;&quot;String&quot;&quot;&gt;&quot; &#43; HttpUtility.HtmlEncode(dc.ColumnName.ToString()) &#43; &quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;);
                }

                sb.AppendLine(&quot;&lt;/Row&gt;&quot;);

                // Add each Row

                foreach (DataRow dr2 in tbl.Rows)
                {
                    sb.AppendLine(&quot;&lt;Row&gt;&quot;);
                    foreach (DataColumn dc in tbl.Columns)
                    {
                        sb.AppendLine(@&quot;&lt;Cell&gt;&lt;Data ss:Type=&quot;&quot;String&quot;&quot;&gt;&quot; &#43; HttpUtility.HtmlEncode(dr2[dc.ColumnName].ToString()) &#43; &quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;);
                    }
                    sb.AppendLine(&quot;&lt;/Row&gt;&quot;);
                }

                sb.AppendLine(&quot;&lt;/Table&gt;&quot;);
                sb.AppendLine(&quot;&lt;/Worksheet&gt;&quot;);

            }
            sb.AppendLine(&quot;&lt;/Workbook&gt;&quot;);

            respObj.Clear();
            respObj.ClearHeaders();
            respObj.ContentType = &quot;application/vnd.ms-excel&quot;;
            respObj.AppendHeader(&quot;content-disposition&quot;, &quot;attachment; filename=&quot; &#43; fileName);

            byte[] myData = System.Text.Encoding.UTF8.GetBytes(sb.ToString());
            respObj.BinaryWrite(myData); // Binary data - see myData -  

        }</pre>
<pre class="hidden">    Public Sub exportDataSetToExcel(ByVal respObj As HttpResponse, ByVal DS As DataSet, ByVal fileName As String)

        fileName = fileName &#43; &quot;.xml&quot;

        Dim sb As New StringBuilder()

        sb.Append(&quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot;?&gt; &quot;)
        sb.AppendLine(&quot;&lt;?mso-application progid=&quot;&quot;Excel.Sheet&quot;&quot;?&gt; &quot;)
        sb.AppendLine(&quot;&lt;Workbook xmlns=&quot;&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;&quot; &quot;)
        sb.AppendLine(&quot;xmlns:x=&quot;&quot;urn:schemas-microsoft-com:office:excel&quot;&quot; &quot;)
        sb.AppendLine(&quot;xmlns:ss=&quot;&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;&quot; &quot;)
        sb.AppendLine(&quot;xmlns:html=&quot;&quot;http://www.w3.org/TR/REC-html40&quot;&quot;&gt; &quot;)
        sb.AppendLine(&quot;&quot;)

        For Each tbl As <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://msdn.microsoft.com/en-US/library/System.Data.DataTable.aspx"  title="Auto generated link to System.Data.DataTable">System.Data.DataTable</a> In DS.Tables

            Dim dc As <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://msdn.microsoft.com/en-US/library/System.Data.DataColumn.aspx"  title="Auto generated link to System.Data.DataColumn">System.Data.DataColumn</a>
            Dim dr As <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://msdn.microsoft.com/en-US/library/System.Data.DataRow.aspx"  title="Auto generated link to System.Data.DataRow">System.Data.DataRow</a>

            sb.AppendLine(&quot;&lt;Worksheet ss:Name=&quot;&quot;&quot; &#43; tbl.TableName &#43; &quot;&quot;&quot;&gt;&quot;)
            sb.AppendLine(&quot;&lt;Table&gt;&quot;)

            ' see XML Spreadsheet Reference https://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx
            sb.AppendLine(&quot;&lt;Column ss:Index=&quot;&quot;1&quot;&quot; ss:AutoFitWidth=&quot;&quot;0&quot;&quot; ss:Width=&quot;&quot;110&quot;&quot;/&gt;&quot;)

            Dim colIndex As Integer = 0
            Dim rowIndex As Integer = 0

            ' First Row as Column's Name
            sb.AppendLine(&quot;&lt;Row&gt;&quot;)
            For Each dc In tbl.Columns
                sb.AppendLine(&quot;&lt;Cell&gt;&lt;Data ss:Type=&quot;&quot;String&quot;&quot;&gt;&quot; &#43; HttpUtility.HtmlEncode(dc.ColumnName.ToString) &#43; &quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;)
            Next
            sb.AppendLine(&quot;&lt;/Row&gt;&quot;)

            ' Add each Row
            For Each dr In tbl.Rows
                sb.AppendLine(&quot;&lt;Row&gt;&quot;)
                For Each dc In tbl.Columns
                    sb.AppendLine(&quot;&lt;Cell&gt;&lt;Data ss:Type=&quot;&quot;String&quot;&quot;&gt;&quot; &#43; HttpUtility.HtmlEncode(dr(dc.ColumnName).ToString) &#43; &quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;)
                Next
                sb.AppendLine(&quot;&lt;/Row&gt;&quot;)
            Next

            sb.AppendLine(&quot;&lt;/Table&gt;&quot;)
            sb.AppendLine(&quot;&lt;/Worksheet&gt;&quot;)

        Next
        sb.AppendLine(&quot;&lt;/Workbook&gt;&quot;)

        respObj.Clear()
        respObj.ClearHeaders()
        respObj.ContentType = &quot;application/vnd.ms-excel&quot;
        respObj.AppendHeader(&quot;content-disposition&quot;, &quot;attachment; filename=&quot; &#43; fileName)

        Dim myData As Byte() = System.Text.Encoding.UTF8.GetBytes(sb.ToString)
        respObj.BinaryWrite(myData)  ' Binary data - see myData -  

    End Sub</pre>
<div class="preview">
<pre class="csharp">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">void</span>&nbsp;exportDataSetToExcel(HttpResponse&nbsp;respObj,&nbsp;DataSet&nbsp;DS,&nbsp;<span class="cs__keyword">string</span>&nbsp;fileName)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileName&nbsp;=&nbsp;fileName&nbsp;&#43;&nbsp;<span class="cs__string">&quot;.xml&quot;</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;StringBuilder();&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.Append(@<span class="cs__string">&quot;&lt;?xml&nbsp;version=&quot;</span><span class="cs__string">&quot;1.0&quot;</span><span class="cs__string">&quot;&nbsp;encoding=&quot;</span><span class="cs__string">&quot;UTF-8&quot;</span><span class="cs__string">&quot;?&gt;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;?mso-application&nbsp;progid=&quot;</span><span class="cs__string">&quot;Excel.Sheet&quot;</span><span class="cs__string">&quot;?&gt;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;Workbook&nbsp;xmlns=&quot;</span><span class="cs__string">&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;</span><span class="cs__string">&quot;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;xmlns:x=&quot;</span><span class="cs__string">&quot;urn:schemas-microsoft-com:office:excel&quot;</span><span class="cs__string">&quot;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;xmlns:ss=&quot;</span><span class="cs__string">&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;</span><span class="cs__string">&quot;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;xmlns:html=&quot;</span><span class="cs__string">&quot;http://www.w3.org/TR/REC-html40&quot;</span><span class="cs__string">&quot;&gt;&nbsp;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(DataTable&nbsp;tbl&nbsp;<span class="cs__keyword">in</span>&nbsp;DS.Tables)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Data.DataRow&nbsp;dr;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;Worksheet&nbsp;ss:Name=&quot;</span><span class="cs__string">&quot;&quot;</span>&nbsp;&#43;&nbsp;tbl.TableName&nbsp;&#43;&nbsp;@<span class="cs__string">&quot;&quot;</span><span class="cs__string">&quot;&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;Table&gt;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;see&nbsp;XML&nbsp;Spreadsheet&nbsp;Reference&nbsp;https://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;Column&nbsp;ss:Index=&quot;</span><span class="cs__string">&quot;1&quot;</span><span class="cs__string">&quot;&nbsp;ss:AutoFitWidth=&quot;</span><span class="cs__string">&quot;0&quot;</span><span class="cs__string">&quot;&nbsp;ss:Width=&quot;</span><span class="cs__string">&quot;110&quot;</span><span class="cs__string">&quot;/&gt;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;First&nbsp;Row&nbsp;as&nbsp;Column's&nbsp;Name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;Row&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(DataColumn&nbsp;dc&nbsp;<span class="cs__keyword">in</span>&nbsp;tbl.Columns)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;Cell&gt;&lt;Data&nbsp;ss:Type=&quot;</span><span class="cs__string">&quot;String&quot;</span><span class="cs__string">&quot;&gt;&quot;</span>&nbsp;&#43;&nbsp;HttpUtility.HtmlEncode(dc.ColumnName.ToString())&nbsp;&#43;&nbsp;<span class="cs__string">&quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;/Row&gt;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__com">//&nbsp;Add&nbsp;each&nbsp;Row</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(DataRow&nbsp;dr2&nbsp;<span class="cs__keyword">in</span>&nbsp;tbl.Rows)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;Row&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(DataColumn&nbsp;dc&nbsp;<span class="cs__keyword">in</span>&nbsp;tbl.Columns)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(@<span class="cs__string">&quot;&lt;Cell&gt;&lt;Data&nbsp;ss:Type=&quot;</span><span class="cs__string">&quot;String&quot;</span><span class="cs__string">&quot;&gt;&quot;</span>&nbsp;&#43;&nbsp;HttpUtility.HtmlEncode(dr2[dc.ColumnName].ToString())&nbsp;&#43;&nbsp;<span class="cs__string">&quot;&lt;/Data&gt;&lt;/Cell&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;/Row&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;/Table&gt;&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;/Worksheet&gt;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.AppendLine(<span class="cs__string">&quot;&lt;/Workbook&gt;&quot;</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;respObj.Clear();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;respObj.ClearHeaders();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;respObj.ContentType&nbsp;=&nbsp;<span class="cs__string">&quot;application/vnd.ms-excel&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;respObj.AppendHeader(<span class="cs__string">&quot;content-disposition&quot;</span>,&nbsp;<span class="cs__string">&quot;attachment;&nbsp;filename=&quot;</span>&nbsp;&#43;&nbsp;fileName);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">byte</span>[]&nbsp;myData&nbsp;=&nbsp;System.Text.Encoding.UTF8.GetBytes(sb.ToString());&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;respObj.BinaryWrite(myData);&nbsp;<span class="cs__com">//&nbsp;Binary&nbsp;data&nbsp;-&nbsp;see&nbsp;myData&nbsp;-&nbsp;&nbsp;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em><em>see project..</em></em> </li></ul>
<h1>More Information</h1>
<p>https://www.codeproject.com/Tips/19840/Export-to-Excel-using-VB-Net&nbsp; &nbsp;</p>
<p>https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://en.wikipedia.org/wiki/Microsoft_Office_XML_formats&nbsp; &nbsp;</p>
<p>https://en.wikipedia.org/wiki/Microsoft_Excel&nbsp; &nbsp;</p>
<p>https://msdn.microsoft.com/en-us/library/aa140066(office.10).aspx</p>
<h4><span class="mw-headline" id="XML_Spreadsheet">XML Spreadsheet</span></h4>
<div class="hatnote navigation-not-searchable">Main article: <a title="Microsoft Office XML formats" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://en.wikipedia.org/wiki/Microsoft_Office_XML_formats">
Microsoft Office XML formats</a></div>
<p>The <em>XML Spreadsheet</em> format introduced in Excel 2002<sup class="reference" id="cite_ref-xml_26-1"><a href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://en.wikipedia.org/wiki/Microsoft_Excel#cite_note-xml-26">[26]</a></sup> is a simple,
<a title="XML" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://en.wikipedia.org/wiki/XML">XML</a> based format missing some more advanced features like storage of VBA macros. Though the intended file extension for this format is
<em>.xml</em>, the program also correctly handles XML files with <em>.xls</em> extension. This feature is widely used by third-party applications (e.g.
<em><a title="MySQL" href="https://code.msdn.microsoft.com/windowsapps/Export-DataSet-to-Excel-d555b6ba/https://en.wikipedia.org/wiki/MySQL">MySQL</a> Query Browser</em>) to offer &quot;export to Excel&quot; capabilities without implementing binary file format. The following example will be correctly opened by Excel if saved either as
<em>Book1.xml</em> or <em>Book1.xls</em>:</p>
<div dir="ltr" class="mw-highlight x_x_mw-content-ltr">
<pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;Workbook</span> <span class="na">xmlns=</span><span class="s">&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;</span>
 <span class="na">xmlns:o=</span><span class="s">&quot;urn:schemas-microsoft-com:office:office&quot;</span>
 <span class="na">xmlns:x=</span><span class="s">&quot;urn:schemas-microsoft-com:office:excel&quot;</span>
 <span class="na">xmlns:ss=</span><span class="s">&quot;urn:schemas-microsoft-com:office:spreadsheet&quot;</span>
 <span class="na">xmlns:html=</span><span class="s">&quot;http://www.w3.org/TR/REC-html40&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;Worksheet</span> <span class="na">ss:Name=</span><span class="s">&quot;Sheet1&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Table</span> <span class="na">ss:ExpandedColumnCount=</span><span class="s">&quot;2&quot;</span> <span class="na">ss:ExpandedRowCount=</span><span class="s">&quot;2&quot;</span> <span class="na">x:FullColumns=</span><span class="s">&quot;1&quot;</span> <span class="na">x:FullRows=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;Row&gt;</span>
    <span class="nt">&lt;Cell&gt;&lt;Data</span> <span class="na">ss:Type=</span><span class="s">&quot;String&quot;</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/Data&gt;&lt;/Cell&gt;</span>
    <span class="nt">&lt;Cell&gt;&lt;Data</span> <span class="na">ss:Type=</span><span class="s">&quot;String&quot;</span><span class="nt">&gt;</span>Example<span class="nt">&lt;/Data&gt;&lt;/Cell&gt;</span>
   <span class="nt">&lt;/Row&gt;</span>
   <span class="nt">&lt;Row&gt;</span>
    <span class="nt">&lt;Cell&gt;&lt;Data</span> <span class="na">ss:Type=</span><span class="s">&quot;String&quot;</span><span class="nt">&gt;</span>Value<span class="nt">&lt;/Data&gt;&lt;/Cell&gt;</span>
    <span class="nt">&lt;Cell&gt;&lt;Data</span> <span class="na">ss:Type=</span><span class="s">&quot;Number&quot;</span><span class="nt">&gt;</span>123<span class="nt">&lt;/Data&gt;&lt;/Cell&gt;</span>
   <span class="nt">&lt;/Row&gt;</span>
  <span class="nt">&lt;/Table&gt;</span>
 <span class="nt">&lt;/Worksheet&gt;</span>
<span class="nt">&lt;/Workbook&gt;</span>
</pre>
</div>

</div>


    </div>
</body>
</html>
