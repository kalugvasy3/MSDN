<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/Header.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/sprite.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/UhfHeader.css" data-do-not-move="true" />
<link rel="stylesheet" href="https://statics-uhf-wus.akamaized.net/west-european/shell/_scrf/css/themes=default.device=uplevel_web_pc/95-bebd50/fa-931df9/52-018a9f/1c-69bb10/e5-670c61/ce-1c4cee/34-6b9bf8/a6-1fffa6?ver=2.0" type="text/css" media="all" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:sprite,0:Footer,1:ImageSprite,2:SelectLocaleFromPopUp;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/WindowsApps/Content:1,/Areas/Epx/Themes/Base/Content:2&amp;amp;v=3A354D42E57BB372C53FC3E210C256E3" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Areas/Epx/Themes/Windows/Content/UhfFooter.css?v=636765551546130442" data-do-not-move="true" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>ASP.NET. How To Upload file from  PC to Application Server / To DataBase BLOB</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/a2847d66-d97b-44f0-8f29-3bb2f3e93543Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/windowsapps/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/windowsapps/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>ASP.NET. How To Upload file from  PC to Application Server / To DataBase BLOB</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            ASP.NET, VB.Net, BLOB, Response
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            VB.Net, Upload File  To Application Server, Upload File to BLOB, Response.Binary<wbr />Write, Read file from Application Server
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Cloud, Phone, Data, Xbox, Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/27/2018</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em>Example How To from User Computer upload file to Application Server or save file to DataBase BLOB column.</em></p>
<h1><span>Building the Sample</span></h1>
<p><em>If you are new to ASP.NET Web Forms but have familiarity with programming concepts, you have the right tutorial. If you are already familiar with ASP.NET Web Forms, you can benefit from this tutorial series by the new features available in ASP.NET 4.0
 ... and Visual Studio 2013. If you are unfamiliar with programming concepts and ASP.NET Web Forms it will be your first ASP net application ... Just start ...</em></p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><strong>Open project with Visual Studio, setup &nbsp;start page to UploadFile.aspx and RUN.</strong></p>
<p><strong>It allow your application to read file from local PC, save it on Application Server, Save it in memory or insert in DataBase BLOB locatuion. &nbsp;It just template/example.</strong></p>
<p>Some code which I used for access to DB I commented out ... If needed you can use DaatCommon class for access to any DataBase...</p>
<p>&nbsp;</p>
<p><em><img id="159802" src="description/Main.PNG" alt="" width="505" height="406">&nbsp; &nbsp;</em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>Save file which you choose from your PC [Browse] to application server.</strong></p>
<p>&nbsp;</p>
<p><img id="159804" src="description/Main3.PNG" alt="" width="556" height="339"></p>
<p>Below screenshort just example, file was swve in &quot;UploadPdf&quot; folder.</p>
<p>&nbsp;</p>
<p><img id="159805" src="description/Main4.PNG" alt="" width="400" height="200"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Here read file in Memory and save bytes to BLOB location in Data Base.</p>
<p>When you save in memory you can read it again from memory to user's PC.&nbsp;</p>
<p>&nbsp;</p>
<p><img id="159806" src="description/Main5.PNG" alt="" width="685" height="404"></p>
<p><em><br>
</em></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">Imports <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.Data.Common.aspx"  title="Auto generated link to System.Data.Common">System.Data.Common</a>
Imports <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.IO.aspx"  title="Auto generated link to System.IO">System.IO</a>

Public Class UploadFile
    Inherits <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.Web.UI.Page.aspx"  title="Auto generated link to System.Web.UI.Page">System.Web.UI.Page</a>

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>) Handles Me.Load
        If Not IsPostBack Then
            'Just for test purpose
            Session(&quot;MyData&quot;) = Nothing
        End If

    End Sub

    'See original  https://msdn.microsoft.com/en-us/library/ms227669.aspx
    'Save file from user PC to Server - need to create folder ~/UploadedPdf/ and grant/verify permission for ApplicationServer - read/write/edit
    Protected Sub btnSaveOnServerForlder_Click(sender As Object, e As EventArgs) Handles btnSaveOnServerForlder.Click

        Dim path As String = Server.MapPath(&quot;~/UploadedPdf/&quot;) 'Server Folder (added this folder to solution) -  Path on Server Side
        Dim fileOK As Boolean = False

        If FileUpload1.HasFile Then

            Dim fileExtension As String
            fileExtension = <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.IO.Path.GetExtension.aspx"  title="Auto generated link to System.IO.Path.GetExtension">System.IO.Path.GetExtension</a>(FileUpload1.FileName).ToLower()

            Dim allowedExtensions As String() = {&quot;.pdf&quot;, &quot;.jpeg&quot;}   ' Just example to extension  .pdf&quot;, &quot;.jpeg 

            For i As Integer = 0 To allowedExtensions.Length - 1
                If fileExtension = allowedExtensions(i) Then
                    fileOK = True
                End If
            Next

            If fileOK Then
                Try
                    FileUpload1.PostedFile.SaveAs(path &amp; FileUpload1.FileName)
                    lblAttention.Text = &quot;File uploaded to Server Folder!&quot;
                    lblAttention.ForeColor = Drawing.Color.Green
                Catch ex As Exception
                    lblAttention.Text = &quot;File could not be uploaded.&quot;
                    lblAttention.ForeColor = Drawing.Color.Red
                End Try
            Else
                lblAttention.Text = &quot;Cannot accept files of this type.&quot;
                lblAttention.ForeColor = Drawing.Color.Pink
            End If
        End If

    End Sub


    Protected Sub btnSaveToMemory_Click(sender As Object, e As EventArgs) Handles btnSaveToMemory.Click
        Dim fileOK As Boolean = False
        Dim strError As String = &quot;&quot;

        ' See class DataCommon
        ' Or go to https://code.msdn.microsoft.com/windowsapps/DataCommon-Class-Access-to-95b43838
        ' Uncomment and insert your connection string , see web.config 

        'Dim db As DataCommon = New DataCommon()
        'Dim cmd As DbCommand = db.commandDB

        If FileUpload1.HasFile Then

            Dim fileExtension As String
            fileExtension = <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.IO.Path.GetExtension.aspx"  title="Auto generated link to System.IO.Path.GetExtension">System.IO.Path.GetExtension</a>(FileUpload1.FileName).ToLower()

            Dim allowedExtensions As String() = {&quot;.pdf&quot;, &quot;.jpeg&quot;}   ' Just example to extension  .pdf&quot;, &quot;.jpeg 

            For i As Integer = 0 To allowedExtensions.Length - 1
                If fileExtension = allowedExtensions(i) Then
                    fileOK = True
                End If
            Next

            If fileOK Then
                Try
                    Dim myFile As HttpPostedFile = FileUpload1.PostedFile

                    Dim myData As Byte() = New Byte(myFile.ContentLength) {}    ' see above it was made common - for test purpose...
                    myFile.InputStream.Read(myData, 0, myFile.ContentLength) ' Read to memory ... 

                    'Below Template how to insert to DB - you need to use BLOB type...

                    'Dim dic As Dictionary(Of String, Object) = New Dictionary(Of String, Object) From {{&quot;@pPKname&quot;, &quot;MyFilesName&quot;}, {&quot;@pBLOB&quot;, myData}}
                    'cmd.CommandText = &quot;procInsertBlob&quot;
                    'db.ExecuteSqlNonQuery(cmd, CommandType.StoredProcedure, dic)

                    Session(&quot;MyData&quot;) = myData ' for test third button I save result to session ...

                    lblAttention.Text = &quot;File uploaded to DB (Memory)!&quot;
                    lblAttention.ForeColor = Drawing.Color.Green

                Catch ex As Exception
                    lblAttention.Text = &quot;File could not be uploaded.&quot;
                    lblAttention.ForeColor = Drawing.Color.Red
                End Try
            Else
                lblAttention.Text = &quot;Cannot accept files of this type.&quot;
                lblAttention.ForeColor = Drawing.Color.Pink
            End If
        End If

    End Sub

    'http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files

    Protected Sub btnReadFromMemoryDB_Click(sender As Object, e As EventArgs) Handles btnReadFromMemoryDB.Click

        Dim db As DataCommon = New DataCommon()
        Dim cmd As DbCommand = db.commandDB

        Dim myData As Byte() ' BLOB

        Dim strFileName As String = &quot;YourFileName.pdf&quot;
        '----------------------------------------------------------
        'cmd.CommandText = &quot;procBringBlob&quot;
        'Dim ds As DataSet = db.GetDataSet(cmd, CommandType.StoredProcedure, New Dictionary(Of String, Object) From {{&quot;@pFileName&quot;, strFileName}})
        'Dim row As DataRow = ds.Tables(0).Rows(0) ' Just example

        'myData = CType(row(&quot;BLOB&quot;), Byte())
        '----------------------------------------------------------

        'myData - Just Example - file here in binary format / could be bring from BLOB database column ...
        If Session(&quot;MyData&quot;) Is Nothing Then
            lblAttention.Text = &quot;For test purpose please Upload in Memory First!&quot; ' It just for test purpose ...
            lblAttention.ForeColor = Drawing.Color.Red
            Exit Sub
        End If

        myData = CType(Session(&quot;MyData&quot;), Byte()) ' I use Session only for test purpose.


        Response.Clear()
        Response.ContentType = &quot;application/pdf&quot;
        Response.AppendHeader(&quot;Content-Disposition&quot;, &quot;attachment; &quot; &#43; strFileName) ' myData - file name (also can be bring from DB)
        Response.BinaryWrite(myData)  ' Binary data - see myData - 
        Response.End()

        lblAttention.Text = &quot;File downloaded from DB!&quot;
        lblAttention.ForeColor = Drawing.Color.Green

    End Sub
End Class</pre>
<div class="preview">
<pre class="vb"><span class="visualBasic__keyword">Imports</span>&nbsp;System.Data.Common&nbsp;
<span class="visualBasic__keyword">Imports</span>&nbsp;System.IO&nbsp;
&nbsp;
<span class="visualBasic__keyword">Public</span>&nbsp;<span class="visualBasic__keyword">Class</span>&nbsp;UploadFile&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Inherits</span>&nbsp;System.Web.UI.Page&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;Page_Load(<span class="visualBasic__keyword">ByVal</span>&nbsp;sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Object</span>,&nbsp;<span class="visualBasic__keyword">ByVal</span>&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.EventArgs.aspx"  title="Auto generated link to System.EventArgs">System.EventArgs</a>)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;<span class="visualBasic__keyword">Me</span>.Load&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;<span class="visualBasic__keyword">Not</span>&nbsp;IsPostBack&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Just&nbsp;for&nbsp;test&nbsp;purpose</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Session(<span class="visualBasic__string">&quot;MyData&quot;</span>)&nbsp;=&nbsp;<span class="visualBasic__keyword">Nothing</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'See&nbsp;original&nbsp;&nbsp;https://msdn.microsoft.com/en-us/library/ms227669.aspx</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Save&nbsp;file&nbsp;from&nbsp;user&nbsp;PC&nbsp;to&nbsp;Server&nbsp;-&nbsp;need&nbsp;to&nbsp;create&nbsp;folder&nbsp;~/UploadedPdf/&nbsp;and&nbsp;grant/verify&nbsp;permission&nbsp;for&nbsp;ApplicationServer&nbsp;-&nbsp;read/write/edit</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;btnSaveOnServerForlder_Click(sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Object</span>,&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;EventArgs)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;btnSaveOnServerForlder.Click&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;path&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;=&nbsp;Server.MapPath(<span class="visualBasic__string">&quot;~/UploadedPdf/&quot;</span>)&nbsp;<span class="visualBasic__com">'Server&nbsp;Folder&nbsp;(added&nbsp;this&nbsp;folder&nbsp;to&nbsp;solution)&nbsp;-&nbsp;&nbsp;Path&nbsp;on&nbsp;Server&nbsp;Side</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;fileOK&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Boolean</span>&nbsp;=&nbsp;<span class="visualBasic__keyword">False</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;FileUpload1.HasFile&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;fileExtension&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileExtension&nbsp;=&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.IO.Path.GetExtension.aspx"  title="Auto generated link to System.IO.Path.GetExtension">System.IO.Path.GetExtension</a>(FileUpload1.FileName).ToLower()&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;allowedExtensions&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>()&nbsp;=&nbsp;{<span class="visualBasic__string">&quot;.pdf&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;.jpeg&quot;</span>}&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Just&nbsp;example&nbsp;to&nbsp;extension&nbsp;&nbsp;.pdf&quot;,&nbsp;&quot;.jpeg&nbsp;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">For</span>&nbsp;i&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Integer</span>&nbsp;=&nbsp;<span class="visualBasic__number">0</span>&nbsp;<span class="visualBasic__keyword">To</span>&nbsp;allowedExtensions.Length&nbsp;-&nbsp;<span class="visualBasic__number">1</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;fileExtension&nbsp;=&nbsp;allowedExtensions(i)&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileOK&nbsp;=&nbsp;<span class="visualBasic__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Next</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;fileOK&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileUpload1.PostedFile.SaveAs(path&nbsp;&amp;&nbsp;FileUpload1.FileName)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;File&nbsp;uploaded&nbsp;to&nbsp;Server&nbsp;Folder!&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Green&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Catch</span>&nbsp;ex&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Exception&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;File&nbsp;could&nbsp;not&nbsp;be&nbsp;uploaded.&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Red&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Cannot&nbsp;accept&nbsp;files&nbsp;of&nbsp;this&nbsp;type.&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Pink&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;btnSaveToMemory_Click(sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Object</span>,&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;EventArgs)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;btnSaveToMemory.Click&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;fileOK&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Boolean</span>&nbsp;=&nbsp;<span class="visualBasic__keyword">False</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;strError&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;=&nbsp;<span class="visualBasic__string">&quot;&quot;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;See&nbsp;class&nbsp;DataCommon</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Or&nbsp;go&nbsp;to&nbsp;https://code.msdn.microsoft.com/windowsapps/DataCommon-Class-Access-to-95b43838</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Uncomment&nbsp;and&nbsp;insert&nbsp;your&nbsp;connection&nbsp;string&nbsp;,&nbsp;see&nbsp;web.config&nbsp;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Dim&nbsp;db&nbsp;As&nbsp;DataCommon&nbsp;=&nbsp;New&nbsp;DataCommon()</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Dim&nbsp;cmd&nbsp;As&nbsp;DbCommand&nbsp;=&nbsp;db.commandDB</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;FileUpload1.HasFile&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;fileExtension&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileExtension&nbsp;=&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://code.msdn.microsoft.com/windowsapps/ASPNET-How-To-Upload-file-2a3e2e08/https://msdn.microsoft.com/en-US/library/System.IO.Path.GetExtension.aspx"  title="Auto generated link to System.IO.Path.GetExtension">System.IO.Path.GetExtension</a>(FileUpload1.FileName).ToLower()&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;allowedExtensions&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>()&nbsp;=&nbsp;{<span class="visualBasic__string">&quot;.pdf&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;.jpeg&quot;</span>}&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Just&nbsp;example&nbsp;to&nbsp;extension&nbsp;&nbsp;.pdf&quot;,&nbsp;&quot;.jpeg&nbsp;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">For</span>&nbsp;i&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Integer</span>&nbsp;=&nbsp;<span class="visualBasic__number">0</span>&nbsp;<span class="visualBasic__keyword">To</span>&nbsp;allowedExtensions.Length&nbsp;-&nbsp;<span class="visualBasic__number">1</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;fileExtension&nbsp;=&nbsp;allowedExtensions(i)&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileOK&nbsp;=&nbsp;<span class="visualBasic__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Next</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;fileOK&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;myFile&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;HttpPostedFile&nbsp;=&nbsp;FileUpload1.PostedFile&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;myData&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Byte</span>()&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;<span class="visualBasic__keyword">Byte</span>(myFile.ContentLength)&nbsp;{}&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;see&nbsp;above&nbsp;it&nbsp;was&nbsp;made&nbsp;common&nbsp;-&nbsp;for&nbsp;test&nbsp;purpose...</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myFile.InputStream.Read(myData,&nbsp;<span class="visualBasic__number">0</span>,&nbsp;myFile.ContentLength)&nbsp;<span class="visualBasic__com">'&nbsp;Read&nbsp;to&nbsp;memory&nbsp;...&nbsp;</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Below&nbsp;Template&nbsp;how&nbsp;to&nbsp;insert&nbsp;to&nbsp;DB&nbsp;-&nbsp;you&nbsp;need&nbsp;to&nbsp;use&nbsp;BLOB&nbsp;type...</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Dim&nbsp;dic&nbsp;As&nbsp;Dictionary(Of&nbsp;String,&nbsp;Object)&nbsp;=&nbsp;New&nbsp;Dictionary(Of&nbsp;String,&nbsp;Object)&nbsp;From&nbsp;{{&quot;@pPKname&quot;,&nbsp;&quot;MyFilesName&quot;},&nbsp;{&quot;@pBLOB&quot;,&nbsp;myData}}</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'cmd.CommandText&nbsp;=&nbsp;&quot;procInsertBlob&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'db.ExecuteSqlNonQuery(cmd,&nbsp;CommandType.StoredProcedure,&nbsp;dic)</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Session(<span class="visualBasic__string">&quot;MyData&quot;</span>)&nbsp;=&nbsp;myData&nbsp;<span class="visualBasic__com">'&nbsp;for&nbsp;test&nbsp;third&nbsp;button&nbsp;I&nbsp;save&nbsp;result&nbsp;to&nbsp;session&nbsp;...</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;File&nbsp;uploaded&nbsp;to&nbsp;DB&nbsp;(Memory)!&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Green&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Catch</span>&nbsp;ex&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;Exception&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;File&nbsp;could&nbsp;not&nbsp;be&nbsp;uploaded.&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Red&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Try</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;Cannot&nbsp;accept&nbsp;files&nbsp;of&nbsp;this&nbsp;type.&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Pink&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Protected</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;btnReadFromMemoryDB_Click(sender&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Object</span>,&nbsp;e&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;EventArgs)&nbsp;<span class="visualBasic__keyword">Handles</span>&nbsp;btnReadFromMemoryDB.Click&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;db&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;DataCommon&nbsp;=&nbsp;<span class="visualBasic__keyword">New</span>&nbsp;DataCommon()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;cmd&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;DbCommand&nbsp;=&nbsp;db.commandDB&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;myData&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">Byte</span>()&nbsp;<span class="visualBasic__com">'&nbsp;BLOB</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Dim</span>&nbsp;strFileName&nbsp;<span class="visualBasic__keyword">As</span>&nbsp;<span class="visualBasic__keyword">String</span>&nbsp;=&nbsp;<span class="visualBasic__string">&quot;YourFileName.pdf&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'----------------------------------------------------------</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'cmd.CommandText&nbsp;=&nbsp;&quot;procBringBlob&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Dim&nbsp;ds&nbsp;As&nbsp;DataSet&nbsp;=&nbsp;db.GetDataSet(cmd,&nbsp;CommandType.StoredProcedure,&nbsp;New&nbsp;Dictionary(Of&nbsp;String,&nbsp;Object)&nbsp;From&nbsp;{{&quot;@pFileName&quot;,&nbsp;strFileName}})</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'Dim&nbsp;row&nbsp;As&nbsp;DataRow&nbsp;=&nbsp;ds.Tables(0).Rows(0)&nbsp;'&nbsp;Just&nbsp;example</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'myData&nbsp;=&nbsp;CType(row(&quot;BLOB&quot;),&nbsp;Byte())</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'----------------------------------------------------------</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__com">'myData&nbsp;-&nbsp;Just&nbsp;Example&nbsp;-&nbsp;file&nbsp;here&nbsp;in&nbsp;binary&nbsp;format&nbsp;/&nbsp;could&nbsp;be&nbsp;bring&nbsp;from&nbsp;BLOB&nbsp;database&nbsp;column&nbsp;...</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;Session(<span class="visualBasic__string">&quot;MyData&quot;</span>)&nbsp;<span class="visualBasic__keyword">Is</span>&nbsp;<span class="visualBasic__keyword">Nothing</span>&nbsp;<span class="visualBasic__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;For&nbsp;test&nbsp;purpose&nbsp;please&nbsp;Upload&nbsp;in&nbsp;Memory&nbsp;First!&quot;</span>&nbsp;<span class="visualBasic__com">'&nbsp;It&nbsp;just&nbsp;for&nbsp;test&nbsp;purpose&nbsp;...</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Red&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">Exit</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myData&nbsp;=&nbsp;<span class="visualBasic__keyword">CType</span>(Session(<span class="visualBasic__string">&quot;MyData&quot;</span>),&nbsp;<span class="visualBasic__keyword">Byte</span>())&nbsp;<span class="visualBasic__com">'&nbsp;I&nbsp;use&nbsp;Session&nbsp;only&nbsp;for&nbsp;test&nbsp;purpose.</span>&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Clear()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.ContentType&nbsp;=&nbsp;<span class="visualBasic__string">&quot;application/pdf&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.AppendHeader(<span class="visualBasic__string">&quot;Content-Disposition&quot;</span>,&nbsp;<span class="visualBasic__string">&quot;attachment;&nbsp;&quot;</span>&nbsp;&#43;&nbsp;strFileName)&nbsp;<span class="visualBasic__com">'&nbsp;myData&nbsp;-&nbsp;file&nbsp;name&nbsp;(also&nbsp;can&nbsp;be&nbsp;bring&nbsp;from&nbsp;DB)</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.BinaryWrite(myData)&nbsp;&nbsp;<span class="visualBasic__com">'&nbsp;Binary&nbsp;data&nbsp;-&nbsp;see&nbsp;myData&nbsp;-&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.<span class="visualBasic__keyword">End</span>()&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.Text&nbsp;=&nbsp;<span class="visualBasic__string">&quot;File&nbsp;downloaded&nbsp;from&nbsp;DB!&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblAttention.ForeColor&nbsp;=&nbsp;Drawing.Color.Green&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Sub</span>&nbsp;
<span class="visualBasic__keyword">End</span>&nbsp;<span class="visualBasic__keyword">Class</span></pre>
</div>
</div>
</div>
<h1>More Information</h1>
<ul>
<li><em>See original &nbsp;https://msdn.microsoft.com/en-us/library/ms227669.aspx</em>
</li><li><em><em>https://code.msdn.microsoft.com/windowsapps/DataCommon-Class-Access-to-95b43838</em></em>
</li><li><em><em>http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files.</em></em>
</li></ul>

</div>


    </div>
</body>
</html>
